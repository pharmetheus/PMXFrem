% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calcFFEM.R
\name{calcFFEM}
\alias{calcFFEM}
\title{calcFFEM}
\usage{
calcFFEM(
  dfext,
  numNonFREMThetas,
  numSkipOm = 0,
  numFREMThetas = length(grep("THETA", names(dfext))) - numNonFREMThetas,
  numSigmas = length(grep("SIGMA", names(dfext))),
  numParCov = NULL,
  parNames = paste("Par", 1:numParCov, sep = ""),
  covNames = paste("Cov", 1:numFREMThetas, sep = ""),
  availCov = covNames,
  quiet = FALSE,
  fremETA = NULL,
  eqFile = "",
  omFile = ""
)
}
\arguments{
\item{dfext}{A data frame of the ext file for the model. In case of multiple $EST, the dfext 
should contain the estimates of the *one* relevant $EST.}

\item{numNonFREMThetas}{Number of thetas that are not FREM covariates. These need to come before the FREM covariate thetas.}

\item{numSkipOm}{Number of diag omegas (variances) that should not be part of the FREM calculations. 
Such omegas has to come before the large FREM omega block.}

\item{numFREMThetas}{The number thetas associated with FREM covariate effects.}

\item{numSigmas}{Number of sigma parameters in the ext file model (including zero sigma covariance elements).}

\item{numParCov}{Number of parameters for which covariate relations are sought (often the same as numNonFREMThetas).
default (NULL) indicates that this is guessed by the function by assuming that each covariate effect is modelled as one theta and one eta.}

\item{parNames}{Names of the parameters}

\item{covNames}{Names of the covariates}

\item{availCov}{Names of the covariates to use in the calculation of the FFEM model.}

\item{quiet}{If FALSE, will print the FFEM model + associated $OMEGA BLOCK}

\item{eqFile}{File name to save the FFEM equations in}

\item{omFile}{File name to save the omega prim matrix in.}

\item{fremEta}{Computes individual eta_prims.}
}
\value{
A list with components Coefficients, Vars and Expr:

Coeffients: The numNonFREMThetas x availCov matrix with FFEM model coefficients

Vars:       The numNonFREMThetas x numNonFREMThetas matrix with the FFEM variances (OMEGA)

Expr:       The vector of FFEM expressions, one for each base model parameter.

Fullvars:   The full FFEM variance-covariance matrix of all OMEGAs in the model.

Uppervars:  The variance-covariance matrix of the skipped OMEGAs in the model.

Eta_prim: The matrix of individual etas re-scaled to FFEM etas.
}
\description{
Computes the corresponding FFEM from a FREM model. Can handle missing covariates.
}
\examples{
\dontrun{
calcFFEM(dfExt,numNonFREMThetas = 9,numSkipOm = 2)
}
}
