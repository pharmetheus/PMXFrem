# calcFFEM output is stable across R versions

    Code
      stabilize(calcFFEMtestout$Coefficients)
    Output
                  [,1]        [,2]        [,3]      [,4]        [,5]        [,6]
      [1,] -0.00590963 -0.02874146 -0.01811160 2.7519542  0.00214845 -0.00465982
      [2,] -0.02645022 -0.02785665 -0.01112850 4.0083250 -0.00061674  0.00029099
      [3,]  0.00556264 -0.01016820 -0.00067872 0.2022808  0.00319232 -0.00894024
                 [,7]       [,8]        [,9]       [,10]       [,11]      [,12]
      [1,] 0.00427376 0.00200909  0.00117027 -0.04997308 -0.16799245 0.00281284
      [2,] 0.00016098 0.00016212 -0.00047057 -0.01460743  0.15345701 0.01971377
      [3,] 0.00616489 0.00228338  0.00188642 -0.02740421 -0.04187465 0.01601249
                [,13]      [,14]       [,15]      [,16]       [,17]      [,18]
      [1,] 0.00800453 -0.5165533 -0.23801639 0.73661473 -0.05330364 0.36693205
      [2,] 0.00167076 -0.0215419  0.02270136 0.73414119 -0.06305799 0.25002251
      [3,] 0.03915737 -0.1740900 -0.10598888 0.01278388 -0.01576026 0.06637223

---

    Code
      stabilize(calcFFEMtestout$FullVars)
    Output
                [,1]  [,2]       [,3]       [,4]       [,5]
      [1,] 0.0541999 0e+00 0.00000000 0.00000000 0.00000000
      [2,] 0.0000000 1e-04 0.00000000 0.00000000 0.00000000
      [3,] 0.0000000 0e+00 0.06518282 0.01968356 0.00522660
      [4,] 0.0000000 0e+00 0.01968356 0.05207309 0.02396877
      [5,] 0.0000000 0e+00 0.00522660 0.02396877 0.04252480

---

    Code
      stabilize(calcFFEMtestout$Expr)
    Output
      [1] "-0.0059096293*(data$Cov1-86.8633) +-0.028741457*(data$Cov2-169.651) +-0.018111601*(data$Cov3-57.5254) 2.7519542*(data$Cov4-2.01183) 0.0021484509*(data$Cov5-43.8226) +-0.0046598199*(data$Cov6-25.5516) 0.004273757*(data$Cov7-28.5493) 0.0020090888*(data$Cov8-9.81901) 0.0011702655*(data$Cov9-119.212) +-0.04997308*(data$Cov10-30.0976) +-0.16799245*(data$Cov11-1.44109) 0.0028128441*(data$Cov12-0.0246596) 0.0080045275*(data$Cov13-0.195798) +-0.51655329*(data$Cov14-0.0224549) +-0.23801639*(data$Cov15-0.157896) 0.73661473*(data$Cov16-1.8036) +-0.053303641*(data$Cov17-0.458201) 0.36693205*(data$Cov18-0.0369864)"     
      [2] "-0.026450223*(data$Cov1-86.8633) +-0.02785665*(data$Cov2-169.651) +-0.011128505*(data$Cov3-57.5254) 4.008325*(data$Cov4-2.01183) +-0.00061673978*(data$Cov5-43.8226) 0.00029099314*(data$Cov6-25.5516) 0.00016098268*(data$Cov7-28.5493) 0.00016211682*(data$Cov8-9.81901) +-0.00047057256*(data$Cov9-119.212) +-0.014607433*(data$Cov10-30.0976) 0.15345701*(data$Cov11-1.44109) 0.019713774*(data$Cov12-0.0246596) 0.0016707637*(data$Cov13-0.195798) +-0.021541902*(data$Cov14-0.0224549) 0.022701356*(data$Cov15-0.157896) 0.73414119*(data$Cov16-1.8036) +-0.063057992*(data$Cov17-0.458201) 0.25002251*(data$Cov18-0.0369864)"  
      [3] "0.0055626371*(data$Cov1-86.8633) +-0.010168196*(data$Cov2-169.651) +-0.00067872409*(data$Cov3-57.5254) 0.20228082*(data$Cov4-2.01183) 0.0031923165*(data$Cov5-43.8226) +-0.0089402409*(data$Cov6-25.5516) 0.0061648945*(data$Cov7-28.5493) 0.0022833753*(data$Cov8-9.81901) 0.0018864159*(data$Cov9-119.212) +-0.027404206*(data$Cov10-30.0976) +-0.041874651*(data$Cov11-1.44109) 0.016012495*(data$Cov12-0.0246596) 0.039157371*(data$Cov13-0.195798) +-0.17409003*(data$Cov14-0.0224549) +-0.10598888*(data$Cov15-0.157896) 0.012783879*(data$Cov16-1.8036) +-0.015760263*(data$Cov17-0.458201) 0.066372226*(data$Cov18-0.0369864)"

---

    Code
      stabilize(calcFFEMtestout$Vars)
    Output
                 [,1]       [,2]       [,3]
      [1,] 0.06518282 0.01968356 0.00522660
      [2,] 0.01968356 0.05207309 0.02396877
      [3,] 0.00522660 0.02396877 0.04252480

---

    Code
      stabilize(calcFFEMtestout$UpperVars)
    Output
                [,1]  [,2]
      [1,] 0.0541999 0e+00
      [2,] 0.0000000 1e-04

---

    Code
      stabilize(calcFFEMtestout$Eta_prim)
    Output
      NULL

---

    Code
      res <- calcFFEM(dfExt, numNonFREMThetas = 7, numSkipOm = 2, quiet = F)
    Output
      Par1:-0.006*(Cov1-86.863)+-0.029*(Cov2-169.651)+-0.018*(Cov3-57.525)+2.752*(Cov4-2.012)+0.002*(Cov5-43.823)+-0.005*(Cov6-25.552)+0.004*(Cov7-28.549)+0.002*(Cov8-9.819)+0.001*(Cov9-119.212)+-0.05*(Cov10-30.098)+-0.168*(Cov11-1.441)+0.003*(Cov12-0.025)+0.008*(Cov13-0.196)+-0.517*(Cov14-0.022)+-0.238*(Cov15-0.158)+0.737*(Cov16-1.804)+-0.053*(Cov17-0.458)+0.367*(Cov18-0.037)
      Par2:-0.026*(Cov1-86.863)+-0.028*(Cov2-169.651)+-0.011*(Cov3-57.525)+4.008*(Cov4-2.012)+-0.001*(Cov5-43.823)+0*(Cov6-25.552)+0*(Cov7-28.549)+0*(Cov8-9.819)+0*(Cov9-119.212)+-0.015*(Cov10-30.098)+0.153*(Cov11-1.441)+0.02*(Cov12-0.025)+0.002*(Cov13-0.196)+-0.022*(Cov14-0.022)+0.023*(Cov15-0.158)+0.734*(Cov16-1.804)+-0.063*(Cov17-0.458)+0.25*(Cov18-0.037)
      Par3:0.006*(Cov1-86.863)+-0.01*(Cov2-169.651)+-0.001*(Cov3-57.525)+0.202*(Cov4-2.012)+0.003*(Cov5-43.823)+-0.009*(Cov6-25.552)+0.006*(Cov7-28.549)+0.002*(Cov8-9.819)+0.002*(Cov9-119.212)+-0.027*(Cov10-30.098)+-0.042*(Cov11-1.441)+0.016*(Cov12-0.025)+0.039*(Cov13-0.196)+-0.174*(Cov14-0.022)+-0.106*(Cov15-0.158)+0.013*(Cov16-1.804)+-0.016*(Cov17-0.458)+0.066*(Cov18-0.037)
      
      $OMEGA BLOCK(3) 
      0.06518
      0.019680.05207
      0.005230.023970.04252
    Code
      stable_res <- stabilize(res)
      stable_res$Expr <- stabilize(res$Expr)
      stable_res
    Output
      $Coefficients
                  [,1]        [,2]        [,3]      [,4]        [,5]        [,6]
      [1,] -0.00590963 -0.02874146 -0.01811160 2.7519542  0.00214845 -0.00465982
      [2,] -0.02645022 -0.02785665 -0.01112850 4.0083250 -0.00061674  0.00029099
      [3,]  0.00556264 -0.01016820 -0.00067872 0.2022808  0.00319232 -0.00894024
                 [,7]       [,8]        [,9]       [,10]       [,11]      [,12]
      [1,] 0.00427376 0.00200909  0.00117027 -0.04997308 -0.16799245 0.00281284
      [2,] 0.00016098 0.00016212 -0.00047057 -0.01460743  0.15345701 0.01971377
      [3,] 0.00616489 0.00228338  0.00188642 -0.02740421 -0.04187465 0.01601249
                [,13]      [,14]       [,15]      [,16]       [,17]      [,18]
      [1,] 0.00800453 -0.5165533 -0.23801639 0.73661473 -0.05330364 0.36693205
      [2,] 0.00167076 -0.0215419  0.02270136 0.73414119 -0.06305799 0.25002251
      [3,] 0.03915737 -0.1740900 -0.10598888 0.01278388 -0.01576026 0.06637223
      
      $Vars
                 [,1]       [,2]       [,3]
      [1,] 0.06518282 0.01968356 0.00522660
      [2,] 0.01968356 0.05207309 0.02396877
      [3,] 0.00522660 0.02396877 0.04252480
      
      $Expr
      [1] "-0.0059096293*(data$Cov1-86.8633) +-0.028741457*(data$Cov2-169.651) +-0.018111601*(data$Cov3-57.5254) 2.7519542*(data$Cov4-2.01183) 0.0021484509*(data$Cov5-43.8226) +-0.0046598199*(data$Cov6-25.5516) 0.004273757*(data$Cov7-28.5493) 0.0020090888*(data$Cov8-9.81901) 0.0011702655*(data$Cov9-119.212) +-0.04997308*(data$Cov10-30.0976) +-0.16799245*(data$Cov11-1.44109) 0.0028128441*(data$Cov12-0.0246596) 0.0080045275*(data$Cov13-0.195798) +-0.51655329*(data$Cov14-0.0224549) +-0.23801639*(data$Cov15-0.157896) 0.73661473*(data$Cov16-1.8036) +-0.053303641*(data$Cov17-0.458201) 0.36693205*(data$Cov18-0.0369864)"     
      [2] "-0.026450223*(data$Cov1-86.8633) +-0.02785665*(data$Cov2-169.651) +-0.011128505*(data$Cov3-57.5254) 4.008325*(data$Cov4-2.01183) +-0.00061673978*(data$Cov5-43.8226) 0.00029099314*(data$Cov6-25.5516) 0.00016098268*(data$Cov7-28.5493) 0.00016211682*(data$Cov8-9.81901) +-0.00047057256*(data$Cov9-119.212) +-0.014607433*(data$Cov10-30.0976) 0.15345701*(data$Cov11-1.44109) 0.019713774*(data$Cov12-0.0246596) 0.0016707637*(data$Cov13-0.195798) +-0.021541902*(data$Cov14-0.0224549) 0.022701356*(data$Cov15-0.157896) 0.73414119*(data$Cov16-1.8036) +-0.063057992*(data$Cov17-0.458201) 0.25002251*(data$Cov18-0.0369864)"  
      [3] "0.0055626371*(data$Cov1-86.8633) +-0.010168196*(data$Cov2-169.651) +-0.00067872409*(data$Cov3-57.5254) 0.20228082*(data$Cov4-2.01183) 0.0031923165*(data$Cov5-43.8226) +-0.0089402409*(data$Cov6-25.5516) 0.0061648945*(data$Cov7-28.5493) 0.0022833753*(data$Cov8-9.81901) 0.0018864159*(data$Cov9-119.212) +-0.027404206*(data$Cov10-30.0976) +-0.041874651*(data$Cov11-1.44109) 0.016012495*(data$Cov12-0.0246596) 0.039157371*(data$Cov13-0.195798) +-0.17409003*(data$Cov14-0.0224549) +-0.10598888*(data$Cov15-0.157896) 0.012783879*(data$Cov16-1.8036) +-0.015760263*(data$Cov17-0.458201) 0.066372226*(data$Cov18-0.0369864)"
      
      $FullVars
                [,1]  [,2]       [,3]       [,4]       [,5]
      [1,] 0.0541999 0e+00 0.00000000 0.00000000 0.00000000
      [2,] 0.0000000 1e-04 0.00000000 0.00000000 0.00000000
      [3,] 0.0000000 0e+00 0.06518282 0.01968356 0.00522660
      [4,] 0.0000000 0e+00 0.01968356 0.05207309 0.02396877
      [5,] 0.0000000 0e+00 0.00522660 0.02396877 0.04252480
      
      $UpperVars
                [,1]  [,2]
      [1,] 0.0541999 0e+00
      [2,] 0.0000000 1e-04
      
      $Eta_prim
      NULL
      

---

    Code
      stabilize(calcFFEMtestout2$Coefficients)
    Output
                  [,1]        [,2]        [,3]      [,4]        [,5]        [,6]
      [1,] -0.00590963 -0.02874146 -0.01811160 2.7519542  0.00214845 -0.00465982
      [2,] -0.02645022 -0.02785665 -0.01112850 4.0083250 -0.00061674  0.00029099
      [3,]  0.00556264 -0.01016820 -0.00067872 0.2022808  0.00319232 -0.00894024
                 [,7]       [,8]        [,9]       [,10]       [,11]      [,12]
      [1,] 0.00427376 0.00200909  0.00117027 -0.04997308 -0.16799245 0.00281284
      [2,] 0.00016098 0.00016212 -0.00047057 -0.01460743  0.15345701 0.01971377
      [3,] 0.00616489 0.00228338  0.00188642 -0.02740421 -0.04187465 0.01601249
                [,13]      [,14]       [,15]      [,16]       [,17]      [,18]
      [1,] 0.00800453 -0.5165533 -0.23801639 0.73661473 -0.05330364 0.36693205
      [2,] 0.00167076 -0.0215419  0.02270136 0.73414119 -0.06305799 0.25002251
      [3,] 0.03915737 -0.1740900 -0.10598888 0.01278388 -0.01576026 0.06637223

---

    Code
      stabilize(calcFFEMtestout2$FullVars)
    Output
                [,1]  [,2]       [,3]       [,4]       [,5]
      [1,] 0.0541999 0e+00 0.00000000 0.00000000 0.00000000
      [2,] 0.0000000 1e-04 0.00000000 0.00000000 0.00000000
      [3,] 0.0000000 0e+00 0.06518282 0.01968356 0.00522660
      [4,] 0.0000000 0e+00 0.01968356 0.05207309 0.02396877
      [5,] 0.0000000 0e+00 0.00522660 0.02396877 0.04252480

---

    Code
      stabilize(calcFFEMtestout2$Expr)
    Output
      [1] "-0.0059096293*(data$Cov1-86.8633) +-0.028741457*(data$Cov2-169.651) +-0.018111601*(data$Cov3-57.5254) 2.7519542*(data$Cov4-2.01183) 0.0021484509*(data$Cov5-43.8226) +-0.0046598199*(data$Cov6-25.5516) 0.004273757*(data$Cov7-28.5493) 0.0020090888*(data$Cov8-9.81901) 0.0011702655*(data$Cov9-119.212) +-0.04997308*(data$Cov10-30.0976) +-0.16799245*(data$Cov11-1.44109) 0.0028128441*(data$Cov12-0.0246596) 0.0080045275*(data$Cov13-0.195798) +-0.51655329*(data$Cov14-0.0224549) +-0.23801639*(data$Cov15-0.157896) 0.73661473*(data$Cov16-1.8036) +-0.053303641*(data$Cov17-0.458201) 0.36693205*(data$Cov18-0.0369864)"     
      [2] "-0.026450223*(data$Cov1-86.8633) +-0.02785665*(data$Cov2-169.651) +-0.011128505*(data$Cov3-57.5254) 4.008325*(data$Cov4-2.01183) +-0.00061673978*(data$Cov5-43.8226) 0.00029099314*(data$Cov6-25.5516) 0.00016098268*(data$Cov7-28.5493) 0.00016211682*(data$Cov8-9.81901) +-0.00047057256*(data$Cov9-119.212) +-0.014607433*(data$Cov10-30.0976) 0.15345701*(data$Cov11-1.44109) 0.019713774*(data$Cov12-0.0246596) 0.0016707637*(data$Cov13-0.195798) +-0.021541902*(data$Cov14-0.0224549) 0.022701356*(data$Cov15-0.157896) 0.73414119*(data$Cov16-1.8036) +-0.063057992*(data$Cov17-0.458201) 0.25002251*(data$Cov18-0.0369864)"  
      [3] "0.0055626371*(data$Cov1-86.8633) +-0.010168196*(data$Cov2-169.651) +-0.00067872409*(data$Cov3-57.5254) 0.20228082*(data$Cov4-2.01183) 0.0031923165*(data$Cov5-43.8226) +-0.0089402409*(data$Cov6-25.5516) 0.0061648945*(data$Cov7-28.5493) 0.0022833753*(data$Cov8-9.81901) 0.0018864159*(data$Cov9-119.212) +-0.027404206*(data$Cov10-30.0976) +-0.041874651*(data$Cov11-1.44109) 0.016012495*(data$Cov12-0.0246596) 0.039157371*(data$Cov13-0.195798) +-0.17409003*(data$Cov14-0.0224549) +-0.10598888*(data$Cov15-0.157896) 0.012783879*(data$Cov16-1.8036) +-0.015760263*(data$Cov17-0.458201) 0.066372226*(data$Cov18-0.0369864)"

---

    Code
      stabilize(calcFFEMtestout2$Vars)
    Output
                 [,1]       [,2]       [,3]
      [1,] 0.06518282 0.01968356 0.00522660
      [2,] 0.01968356 0.05207309 0.02396877
      [3,] 0.00522660 0.02396877 0.04252480

---

    Code
      stabilize(calcFFEMtestout2$UpperVars)
    Output
                [,1]  [,2]
      [1,] 0.0541999 0e+00
      [2,] 0.0000000 1e-04

---

    Code
      res <- calcFFEM(dfExt, numNonFREMThetas = 7, numSkipOm = 2, quiet = F, etaFREM = as.numeric(
        dfPhi[1, ]))
    Output
      Par1:-0.006*(Cov1-86.863)+-0.029*(Cov2-169.651)+-0.018*(Cov3-57.525)+2.752*(Cov4-2.012)+0.002*(Cov5-43.823)+-0.005*(Cov6-25.552)+0.004*(Cov7-28.549)+0.002*(Cov8-9.819)+0.001*(Cov9-119.212)+-0.05*(Cov10-30.098)+-0.168*(Cov11-1.441)+0.003*(Cov12-0.025)+0.008*(Cov13-0.196)+-0.517*(Cov14-0.022)+-0.238*(Cov15-0.158)+0.737*(Cov16-1.804)+-0.053*(Cov17-0.458)+0.367*(Cov18-0.037)
      Par2:-0.026*(Cov1-86.863)+-0.028*(Cov2-169.651)+-0.011*(Cov3-57.525)+4.008*(Cov4-2.012)+-0.001*(Cov5-43.823)+0*(Cov6-25.552)+0*(Cov7-28.549)+0*(Cov8-9.819)+0*(Cov9-119.212)+-0.015*(Cov10-30.098)+0.153*(Cov11-1.441)+0.02*(Cov12-0.025)+0.002*(Cov13-0.196)+-0.022*(Cov14-0.022)+0.023*(Cov15-0.158)+0.734*(Cov16-1.804)+-0.063*(Cov17-0.458)+0.25*(Cov18-0.037)
      Par3:0.006*(Cov1-86.863)+-0.01*(Cov2-169.651)+-0.001*(Cov3-57.525)+0.202*(Cov4-2.012)+0.003*(Cov5-43.823)+-0.009*(Cov6-25.552)+0.006*(Cov7-28.549)+0.002*(Cov8-9.819)+0.002*(Cov9-119.212)+-0.027*(Cov10-30.098)+-0.042*(Cov11-1.441)+0.016*(Cov12-0.025)+0.039*(Cov13-0.196)+-0.174*(Cov14-0.022)+-0.106*(Cov15-0.158)+0.013*(Cov16-1.804)+-0.016*(Cov17-0.458)+0.066*(Cov18-0.037)
      
      $OMEGA BLOCK(3) 
      0.06518
      0.019680.05207
      0.005230.023970.04252
    Code
      stable_res <- stabilize(res)
      stable_res$Expr <- stabilize(res$Expr)
      stable_res
    Output
      $Coefficients
                  [,1]        [,2]        [,3]      [,4]        [,5]        [,6]
      [1,] -0.00590963 -0.02874146 -0.01811160 2.7519542  0.00214845 -0.00465982
      [2,] -0.02645022 -0.02785665 -0.01112850 4.0083250 -0.00061674  0.00029099
      [3,]  0.00556264 -0.01016820 -0.00067872 0.2022808  0.00319232 -0.00894024
                 [,7]       [,8]        [,9]       [,10]       [,11]      [,12]
      [1,] 0.00427376 0.00200909  0.00117027 -0.04997308 -0.16799245 0.00281284
      [2,] 0.00016098 0.00016212 -0.00047057 -0.01460743  0.15345701 0.01971377
      [3,] 0.00616489 0.00228338  0.00188642 -0.02740421 -0.04187465 0.01601249
                [,13]      [,14]       [,15]      [,16]       [,17]      [,18]
      [1,] 0.00800453 -0.5165533 -0.23801639 0.73661473 -0.05330364 0.36693205
      [2,] 0.00167076 -0.0215419  0.02270136 0.73414119 -0.06305799 0.25002251
      [3,] 0.03915737 -0.1740900 -0.10598888 0.01278388 -0.01576026 0.06637223
      
      $Vars
                 [,1]       [,2]       [,3]
      [1,] 0.06518282 0.01968356 0.00522660
      [2,] 0.01968356 0.05207309 0.02396877
      [3,] 0.00522660 0.02396877 0.04252480
      
      $Expr
      [1] "-0.0059096293*(data$Cov1-86.8633) +-0.028741457*(data$Cov2-169.651) +-0.018111601*(data$Cov3-57.5254) 2.7519542*(data$Cov4-2.01183) 0.0021484509*(data$Cov5-43.8226) +-0.0046598199*(data$Cov6-25.5516) 0.004273757*(data$Cov7-28.5493) 0.0020090888*(data$Cov8-9.81901) 0.0011702655*(data$Cov9-119.212) +-0.04997308*(data$Cov10-30.0976) +-0.16799245*(data$Cov11-1.44109) 0.0028128441*(data$Cov12-0.0246596) 0.0080045275*(data$Cov13-0.195798) +-0.51655329*(data$Cov14-0.0224549) +-0.23801639*(data$Cov15-0.157896) 0.73661473*(data$Cov16-1.8036) +-0.053303641*(data$Cov17-0.458201) 0.36693205*(data$Cov18-0.0369864)"     
      [2] "-0.026450223*(data$Cov1-86.8633) +-0.02785665*(data$Cov2-169.651) +-0.011128505*(data$Cov3-57.5254) 4.008325*(data$Cov4-2.01183) +-0.00061673978*(data$Cov5-43.8226) 0.00029099314*(data$Cov6-25.5516) 0.00016098268*(data$Cov7-28.5493) 0.00016211682*(data$Cov8-9.81901) +-0.00047057256*(data$Cov9-119.212) +-0.014607433*(data$Cov10-30.0976) 0.15345701*(data$Cov11-1.44109) 0.019713774*(data$Cov12-0.0246596) 0.0016707637*(data$Cov13-0.195798) +-0.021541902*(data$Cov14-0.0224549) 0.022701356*(data$Cov15-0.157896) 0.73414119*(data$Cov16-1.8036) +-0.063057992*(data$Cov17-0.458201) 0.25002251*(data$Cov18-0.0369864)"  
      [3] "0.0055626371*(data$Cov1-86.8633) +-0.010168196*(data$Cov2-169.651) +-0.00067872409*(data$Cov3-57.5254) 0.20228082*(data$Cov4-2.01183) 0.0031923165*(data$Cov5-43.8226) +-0.0089402409*(data$Cov6-25.5516) 0.0061648945*(data$Cov7-28.5493) 0.0022833753*(data$Cov8-9.81901) 0.0018864159*(data$Cov9-119.212) +-0.027404206*(data$Cov10-30.0976) +-0.041874651*(data$Cov11-1.44109) 0.016012495*(data$Cov12-0.0246596) 0.039157371*(data$Cov13-0.195798) +-0.17409003*(data$Cov14-0.0224549) +-0.10598888*(data$Cov15-0.157896) 0.012783879*(data$Cov16-1.8036) +-0.015760263*(data$Cov17-0.458201) 0.066372226*(data$Cov18-0.0369864)"
      
      $FullVars
                [,1]  [,2]       [,3]       [,4]       [,5]
      [1,] 0.0541999 0e+00 0.00000000 0.00000000 0.00000000
      [2,] 0.0000000 1e-04 0.00000000 0.00000000 0.00000000
      [3,] 0.0000000 0e+00 0.06518282 0.01968356 0.00522660
      [4,] 0.0000000 0e+00 0.01968356 0.05207309 0.02396877
      [5,] 0.0000000 0e+00 0.00522660 0.02396877 0.04252480
      
      $UpperVars
                [,1]  [,2]
      [1,] 0.0541999 0e+00
      [2,] 0.0000000 1e-04
      
      $Eta_prim
      NULL
      

---

    Code
      stabilize(calcFFEMtestout3$Coefficients)
    Output
                 [,1]        [,2]
      [1,] 0.00648239  0.09784729
      [2,] 0.01183965  0.30557009
      [3,] 0.00072112 -0.00976671

---

    Code
      stabilize(calcFFEMtestout3$FullVars)
    Output
                [,1]  [,2]       [,3]       [,4]       [,5]
      [1,] 0.0541999 0e+00 0.00000000 0.00000000 0.00000000
      [2,] 0.0000000 1e-04 0.00000000 0.00000000 0.00000000
      [3,] 0.0000000 0e+00 0.16784423 0.10932929 0.01190634
      [4,] 0.0000000 0e+00 0.10932929 0.14127678 0.02567112
      [5,] 0.0000000 0e+00 0.01190634 0.02567112 0.04707217

---

    Code
      stabilize(calcFFEMtestout3$Expr)
    Output
      [1] "0.0064823937*(data$WT-86.8633) 0.097847294*(data$SEX-1.44109)"   
      [2] "0.011839645*(data$WT-86.8633) 0.30557009*(data$SEX-1.44109)"     
      [3] "0.0007211165*(data$WT-86.8633) +-0.0097667093*(data$SEX-1.44109)"

---

    Code
      stabilize(calcFFEMtestout3$Vars)
    Output
                 [,1]       [,2]       [,3]
      [1,] 0.16784423 0.10932929 0.01190634
      [2,] 0.10932929 0.14127678 0.02567112
      [3,] 0.01190634 0.02567112 0.04707217

---

    Code
      stabilize(calcFFEMtestout3$UpperVars)
    Output
                [,1]  [,2]
      [1,] 0.0541999 0e+00
      [2,] 0.0000000 1e-04

---

    Code
      stabilize(calcFFEMtestout3$Eta_prim)
    Output
      NULL

---

    Code
      res <- calcFFEMtestout3
      stable_res <- stabilize(res)
      stable_res$Expr <- stabilize(res$Expr)
      stable_res
    Output
      $Coefficients
                 [,1]        [,2]
      [1,] 0.00648239  0.09784729
      [2,] 0.01183965  0.30557009
      [3,] 0.00072112 -0.00976671
      
      $Vars
                 [,1]       [,2]       [,3]
      [1,] 0.16784423 0.10932929 0.01190634
      [2,] 0.10932929 0.14127678 0.02567112
      [3,] 0.01190634 0.02567112 0.04707217
      
      $Expr
      [1] "0.0064823937*(data$WT-86.8633) 0.097847294*(data$SEX-1.44109)"   
      [2] "0.011839645*(data$WT-86.8633) 0.30557009*(data$SEX-1.44109)"     
      [3] "0.0007211165*(data$WT-86.8633) +-0.0097667093*(data$SEX-1.44109)"
      
      $FullVars
                [,1]  [,2]       [,3]       [,4]       [,5]
      [1,] 0.0541999 0e+00 0.00000000 0.00000000 0.00000000
      [2,] 0.0000000 1e-04 0.00000000 0.00000000 0.00000000
      [3,] 0.0000000 0e+00 0.16784423 0.10932929 0.01190634
      [4,] 0.0000000 0e+00 0.10932929 0.14127678 0.02567112
      [5,] 0.0000000 0e+00 0.01190634 0.02567112 0.04707217
      
      $UpperVars
                [,1]  [,2]
      [1,] 0.0541999 0e+00
      [2,] 0.0000000 1e-04
      
      $Eta_prim
      NULL
      

---

    Code
      stabilize(calcFFEMtestout4$Coefficients)
    Output
                 [,1]        [,2]
      [1,] 0.00698637 -0.00575916
      [2,] 0.01190124 -0.01170362
      [3,] 0.00076117  0.00019950

---

    Code
      stabilize(calcFFEMtestout4$FullVars)
    Output
                [,1]  [,2]       [,3]       [,4]       [,5]
      [1,] 0.0541999 0e+00 0.00000000 0.00000000 0.00000000
      [2,] 0.0000000 1e-04 0.00000000 0.00000000 0.00000000
      [3,] 0.0000000 0e+00 0.16724976 0.11033185 0.01179485
      [4,] 0.0000000 0e+00 0.11033185 0.15021772 0.02522389
      [5,] 0.0000000 0e+00 0.01179485 0.02522389 0.04708922

---

    Code
      stabilize(calcFFEMtestout4$Expr)
    Output
      [1] "0.0069863748*(data$Cov1-86.8633) +-0.0057591642*(data$Cov2-169.651)"
      [2] "0.011901244*(data$Cov1-86.8633) +-0.011703621*(data$Cov2-169.651)"  
      [3] "0.00076117443*(data$Cov1-86.8633) 0.00019950185*(data$Cov2-169.651)"

---

    Code
      stabilize(calcFFEMtestout4$Vars)
    Output
                 [,1]       [,2]       [,3]
      [1,] 0.16724976 0.11033185 0.01179485
      [2,] 0.11033185 0.15021772 0.02522389
      [3,] 0.01179485 0.02522389 0.04708922

---

    Code
      stabilize(calcFFEMtestout4$UpperVars)
    Output
                [,1]  [,2]
      [1,] 0.0541999 0e+00
      [2,] 0.0000000 1e-04

---

    Code
      stabilize(calcFFEMtestout4$Eta_prim)
    Output
      NULL

---

    Code
      res <- calcFFEMtestout4
      stable_res <- stabilize(res)
      stable_res$Expr <- stabilize(res$Expr)
      stable_res
    Output
      $Coefficients
                 [,1]        [,2]
      [1,] 0.00698637 -0.00575916
      [2,] 0.01190124 -0.01170362
      [3,] 0.00076117  0.00019950
      
      $Vars
                 [,1]       [,2]       [,3]
      [1,] 0.16724976 0.11033185 0.01179485
      [2,] 0.11033185 0.15021772 0.02522389
      [3,] 0.01179485 0.02522389 0.04708922
      
      $Expr
      [1] "0.0069863748*(data$Cov1-86.8633) +-0.0057591642*(data$Cov2-169.651)"
      [2] "0.011901244*(data$Cov1-86.8633) +-0.011703621*(data$Cov2-169.651)"  
      [3] "0.00076117443*(data$Cov1-86.8633) 0.00019950185*(data$Cov2-169.651)"
      
      $FullVars
                [,1]  [,2]       [,3]       [,4]       [,5]
      [1,] 0.0541999 0e+00 0.00000000 0.00000000 0.00000000
      [2,] 0.0000000 1e-04 0.00000000 0.00000000 0.00000000
      [3,] 0.0000000 0e+00 0.16724976 0.11033185 0.01179485
      [4,] 0.0000000 0e+00 0.11033185 0.15021772 0.02522389
      [5,] 0.0000000 0e+00 0.01179485 0.02522389 0.04708922
      
      $UpperVars
                [,1]  [,2]
      [1,] 0.0541999 0e+00
      [2,] 0.0000000 1e-04
      
      $Eta_prim
      NULL
      

